{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{450:function(t,a,s){\"use strict\";s.r(a);var n=s(69),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[s(\"h1\",{attrs:{id:\"loki\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#loki\"}},[t._v(\"#\")]),t._v(\" Loki\")]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://grafana.com/docs/loki/next/fundamentals/overview/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Loki官方文档\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://github.com/linqianye/loki-doc/tree/main/docs\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Loki中文文档\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://github.com/grafana/loki\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Loki开源地址\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"h2\",{attrs:{id:\"简单应用场景说明\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#简单应用场景说明\"}},[t._v(\"#\")]),t._v(\" 简单应用场景说明\")]),t._v(\" \"),s(\"p\",[t._v(\"需求：下载近七天日志\")]),t._v(\" \"),s(\"p\",[t._v(\"实现：每隔一小时定期上传日志，平台监测并将上传的日志存储到loki，点击下载时直接根据时间段从loki中取近七天日志\")]),t._v(\" \"),s(\"h2\",{attrs:{id:\"概述\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#概述\"}},[t._v(\"#\")]),t._v(\" 概述\")]),t._v(\" \"),s(\"p\",[t._v(\"Loki：轻量级日志系统\")]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"特点：\")])]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"Go语言实现\")]),t._v(\" \"),s(\"li\",[t._v(\"日志采集\")]),t._v(\" \"),s(\"li\",[t._v(\"日志压缩存储\")]),t._v(\" \"),s(\"li\",[t._v(\"标签分组\")]),t._v(\" \"),s(\"li\",[t._v(\"日志可视化\")]),t._v(\" \"),s(\"li\",[t._v(\"可扩展性（每个组件都可以单独运行）\")]),t._v(\" \"),s(\"li\",[t._v(\"多租户（通过Promtail分配tenantID，租户ID从请求的HTTP Header提取）\")]),t._v(\" \"),s(\"li\",[t._v(\"LogQL（有小小的学习成本）\")]),t._v(\" \"),s(\"li\",[t._v(\"中小数据量比较适合\")])]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"对比ELK:\")])]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"轻量\")]),t._v(\" \"),s(\"li\",[t._v(\"存储成本低\")]),t._v(\" \"),s(\"li\",[t._v(\"检索能力较差\")]),t._v(\" \"),s(\"li\",[t._v(\"功能单一，数据处理及清洗没有ELK强大\")])]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"场景说明：\")])]),t._v(\" \"),s(\"p\",[t._v(\"适用：\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"查看日志解决故障\")]),t._v(\" \"),s(\"li\",[t._v(\"少量小范围的日志查看，如5分钟内的日志，5分钟前的500条日志\")]),t._v(\" \"),s(\"li\",[t._v(\"分布式系统日志查看\")]),t._v(\" \"),s(\"li\",[t._v(\"基于k8s日志收集\")])]),t._v(\" \"),s(\"p\",[t._v(\"不适用：\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"大型数据聚合和统一分析\")]),t._v(\" \"),s(\"li\",[t._v(\"大范围查询日志\")]),t._v(\" \"),s(\"li\",[t._v(\"依赖内存，可能OOM\")])]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"原理：\")])]),t._v(\" \"),s(\"p\",[t._v(\"为每个日志流设置一组标签，根据标签索引\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"Promtail，基于prometheus，采集客户端日志加上标签发送给Loki（代理获取日志将日志转换成流并通过HTTP API将流推送给Loki）\")]),t._v(\" \"),s(\"li\",[t._v(\"Loki，日志存储解析，并提供查询API给下游展示\")]),t._v(\" \"),s(\"li\",[t._v(\"Grafana，从Loki中获取日志信息，可视化展示\")])]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1648631882869-fd010ff6-0514-42e5-88a1-482a5930f64c.png\",alt:\"img\"}})]),t._v(\" \"),s(\"p\",[t._v(\"日志数据本身也会被压缩\")]),t._v(\" \"),s(\"p\",[t._v(\"Loki能够以微服务模式运行，也就是把自身的各个模块分解出单个进程，比如横向扩展多个查询器模块可提高查询性能\")]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"组件：\")])]),t._v(\" \"),s(\"p\",[t._v(\"promtail会将日志推送至Loki提供的基于Http的API，Loki将收到的日志按照标签进行分发存储，并在需要时使用LogQL进行查询\")]),t._v(\" \"),s(\"p\",[t._v(\"Loki实现由众多的组件组成，每个组件都会拉起一个gRPC服务实现内部互通，同时也对外暴露一个HTTP/1的服务来提供外部服务以应答API请求\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1648629990574-7de093e5-90a2-4ac8-a4b3-3cb6ce4100b8.png\",alt:\"img\"}})]),t._v(\" \"),s(\"ul\",[s(\"li\",[s(\"p\",[t._v(\"Distributor，分发从客户端上报的日志，校验完后分发给ingester处理，一致性哈希\")])]),t._v(\" \"),s(\"li\",[s(\"p\",[t._v(\"Ingester，将日志转储到后端存储，负责构建和刷新chunck（内存缓存刷盘）\")])]),t._v(\" \"),s(\"li\",[s(\"p\",[t._v(\"Query frontend（optional），加速查询\")])]),t._v(\" \"),s(\"li\",[s(\"p\",[t._v(\"Querier，查询\")])]),t._v(\" \"),s(\"li\",[s(\"p\",[t._v(\"Chunk Store，后端存储框架，索引存储/日志数据存储\")])]),t._v(\" \"),s(\"li\",[s(\"ul\",[s(\"li\",[t._v(\"索引存储，Amazon DynamoDB, Google Bigtable, Apsache Cassandra\")]),t._v(\" \"),s(\"li\",[t._v(\"日志存储，Amazon DynamoDB, Google Bigtable, Apsache Cassandra, Amazon S3, Google Cloud Store\")])])])]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"安装部署\")])]),t._v(\" \"),s(\"p\",[t._v(\"https://grafana.com/docs/loki/next/installation/\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"适用Tanka安装\")]),t._v(\" \"),s(\"li\",[t._v(\"Helm+k8s（适用Loki微服务模式）\")]),t._v(\" \"),s(\"li\",[t._v(\"docker-compose安装\")]),t._v(\" \"),s(\"li\",[t._v(\"本地安装运行\")]),t._v(\" \"),s(\"li\",[t._v(\"从源代码安装\")])]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"一般流程\")])]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"下载安装Loki和Promtail\")]),t._v(\" \"),s(\"li\",[t._v(\"下载两个的配置文件\")]),t._v(\" \"),s(\"li\",[t._v(\"启动Loki\")]),t._v(\" \"),s(\"li\",[t._v(\"更新Promtail的配置文件\")]),t._v(\" \"),s(\"li\",[t._v(\"启动Promtail\")])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"loki-http-api\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#loki-http-api\"}},[t._v(\"#\")]),t._v(\" Loki HTTP API\")]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"如果需要直接向Loki推送日志，可以直接调用Loki HTTP API\")])]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"列出了一些常用的API如下\")])]),t._v(\" \"),s(\"p\",[t._v(\"返回结果类型：\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"矩阵：一个数值表，其中每一行代表一个不同的标签集，列是该行在被查询时间内的每个样本值。矩阵类型只有在运行计算一些数值的查询时才会返回。\")]),t._v(\" \"),s(\"li\",[t._v(\"即时向量：在类型中仅表示为 ，即时向量表示给定标签集的计算的最新值。即时向量只在针对单一时间点进行查询时返回。\")]),t._v(\" \"),s(\"li\",[t._v(\"流：流是一组给定标签集在查询时间范围内的所有值（日志）。流是唯一会导致日志行被返回的类型。\")])]),t._v(\" \"),s(\"h3\",{attrs:{id:\"查询日志流\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#查询日志流\"}},[t._v(\"#\")]),t._v(\" 查询日志流\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"get-loki-api-v1-query-允许对单一时间点执行查询\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#get-loki-api-v1-query-允许对单一时间点执行查询\"}},[t._v(\"#\")]),t._v(\" \"),s(\"code\",[t._v(\"GET /loki/api/v1/query\")]),s(\"strong\",[t._v(\"（允许对单一时间点执行查询）\")])]),t._v(\" \"),s(\"p\",[t._v(\"参数：\")]),t._v(\" \"),s(\"p\",[t._v(\"query：要执行的LogQL查询\")]),t._v(\" \"),s(\"p\",[t._v(\"limit: 要返回的最大条目数\")]),t._v(\" \"),s(\"p\",[t._v(\"time: 查询的评估时间作为一个纳秒的 Unix 纪元。默认为现在。\")]),t._v(\" \"),s(\"p\",[t._v(\"direction：确定日志的排序顺序。支持的值为forward或backward。默认为backward\")]),t._v(\" \"),s(\"p\",[t._v(\"示例：\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-json extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[s(\"code\",[t._v(\"http\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//192.168.15.139:30100/loki/api/v1/query\")]),t._v(\"\\n?direction=BACKWARD\\n&limit=\"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1000\")]),t._v(\"\\n&query=sum(rate(\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"job=\"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"anychatlog\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"2d\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"))\\n\")])])]),s(\"h4\",{attrs:{id:\"get-loki-api-v1-query-range-查询某个时间段日志\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#get-loki-api-v1-query-range-查询某个时间段日志\"}},[t._v(\"#\")]),t._v(\" \"),s(\"code\",[t._v(\"GET /loki/api/v1/query_range\")]),s(\"strong\",[t._v(\"（查询某个时间段日志）\")])]),t._v(\" \"),s(\"p\",[t._v(\"参数：\")]),t._v(\" \"),s(\"p\",[t._v(\"query：要执行的LogQL查询\")]),t._v(\" \"),s(\"p\",[t._v(\"limit: 要返回的最大条目数\")]),t._v(\" \"),s(\"p\",[t._v(\"start: 查询的开始时间，以纳秒 Unix 纪元表示。默认为一小时前。\")]),t._v(\" \"),s(\"p\",[t._v(\"end: 查询的结束时间，以纳秒 Unix 纪元表示。默认为现在。\")]),t._v(\" \"),s(\"p\",[t._v(\"step: 以duration格式或浮点秒数查询分辨率步长。duration指形式为 的 Prometheus 持续时间字符串[0-9]+[smhdwy]。例如，5m 表示持续时间为 5 分钟。默认为基于start和的动态值end。仅适用于产生矩阵响应的查询类型。\")]),t._v(\" \"),s(\"p\",[t._v(\"interval：这个参数是实验性的；请参阅step vs interval下的说明。只返回（或大于）指定间隔的条目，可以是duration格式或浮点数。仅适用于产生流响应的查询。\")]),t._v(\" \"),s(\"p\",[t._v(\"direction：确定日志的排序顺序。支持的值为forward或backward。默认为backward.\")]),t._v(\" \"),s(\"p\",[t._v(\"示例：\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-json extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[s(\"code\",[t._v(\"http\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//192.168.15.139:30100/loki/api/v1/query_range\")]),t._v(\"\\n?direction=BACKWARD\\n&limit=\"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1000\")]),t._v(\"\\n&query=\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"job=\"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"anychatlog\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \\n&start=\"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1641280408415000000\")]),t._v(\"\\n&end=\"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1641453208415000000\")]),t._v(\"\\n&step=\"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"120\")]),t._v(\"\\n\")])])]),s(\"h3\",{attrs:{id:\"查询标签\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#查询标签\"}},[t._v(\"#\")]),t._v(\" 查询标签\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"get-loki-api-v1-labels-查询标签列表\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#get-loki-api-v1-labels-查询标签列表\"}},[t._v(\"#\")]),t._v(\" \"),s(\"code\",[t._v(\"GET /loki/api/v1/labels\")]),s(\"strong\",[t._v(\"（查询标签列表）\")])]),t._v(\" \"),s(\"p\",[t._v(\"参数：\")]),t._v(\" \"),s(\"p\",[t._v(\"start：开始时间，默认为6小时前\")]),t._v(\" \"),s(\"p\",[t._v(\"end：查询结束时间，默认为现在\")]),t._v(\" \"),s(\"p\",[t._v(\"示例：\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-json extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[s(\"code\",[t._v(\" http\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//192.168.15.139:30100/loki/api/v1/labels\")]),t._v(\"\\n\")])])]),s(\"h4\",{attrs:{id:\"get-loki-api-v1-label-name-values-查询标签值\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#get-loki-api-v1-label-name-values-查询标签值\"}},[t._v(\"#\")]),t._v(\" \"),s(\"code\",[t._v(\"GET /loki/api/v1/label/<name>/values\")]),t._v(\"(查询标签值)\")]),t._v(\" \"),s(\"p\",[t._v(\"参数：\")]),t._v(\" \"),s(\"p\",[t._v(\"name：GET /loki/api/v1/label中的标签\")]),t._v(\" \"),s(\"p\",[t._v(\"start：开始时间，默认为6小时前\")]),t._v(\" \"),s(\"p\",[t._v(\"end：查询结束时间，默认为现在\")]),t._v(\" \"),s(\"p\",[t._v(\"示例：\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-json extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[s(\"code\",[t._v(\"http\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//192.168.15.139:30100/loki/api/v1/label/job/values\")]),t._v(\"\\n\")])])]),s(\"h3\",{attrs:{id:\"匹配特定标签集列表\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#匹配特定标签集列表\"}},[t._v(\"#\")]),t._v(\" 匹配特定标签集列表\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-json extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[s(\"code\",[t._v(\"GET /loki/api/v1/series\\nPOST /loki/api/v1/series\\n\")])])]),s(\"p\",[t._v(\"参数：\")]),t._v(\" \"),s(\"p\",[t._v(\"match[]=<series_selector>：选择要返回的日志流的标签。match[]必须至少提供一个参数。\")]),t._v(\" \"),s(\"p\",[t._v(\"start=: 开始时间戳。\")]),t._v(\" \"),s(\"p\",[t._v(\"end=: 结束时间戳。\")]),t._v(\" \"),s(\"p\",[t._v(\"示例：\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-json extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[s(\"code\",[t._v(\"http\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//192.168.15.139:30100/loki/api/v1/series\")]),t._v(\"\\n?start=\"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1640922291907000000\")]),t._v(\"\\n&end=\"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1641527091908000000\")]),t._v(\"\\n&match\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"=\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"host=\"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"192.168.11.123\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),s(\"h3\",{attrs:{id:\"删除日志流\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#删除日志流\"}},[t._v(\"#\")]),t._v(\" 删除日志流\")]),t._v(\" \"),s(\"p\",[t._v(\"需要2.3.0以上版本的Loki，并按官方文档进行配置\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"删除日志流-2\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#删除日志流-2\"}},[t._v(\"#\")]),t._v(\" 删除日志流\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-java extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[s(\"code\",[t._v(\"POST loki_addr\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"loki\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"api\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"admin\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"delete\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"?\")]),t._v(\"match\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"\\n\")])])]),s(\"p\",[t._v(\"参数：\")]),t._v(\" \"),s(\"p\",[t._v(\"match[]:标签匹配器，用于标识要从中删除的流,必须至少提供一个参数\")]),t._v(\" \"),s(\"p\",[t._v(\"<series_selector>:查询参数\")]),t._v(\" \"),s(\"p\",[t._v(\"start:开始的时间戳\")]),t._v(\" \"),s(\"p\",[t._v(\"end:结束的时间戳\")]),t._v(\" \"),s(\"p\",[t._v(\"示例：\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-java extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[s(\"code\",[t._v(\"http\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"192.168\")]),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\".15\")]),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\".139\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"30100\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"loki\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"api\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"admin\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"delete\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"?\")]),t._v(\"match\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"job\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"anychatlog\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),s(\"h3\",{attrs:{id:\"推送日志\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#推送日志\"}},[t._v(\"#\")]),t._v(\" 推送日志\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"post-loki-api-v1-push\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#post-loki-api-v1-push\"}},[t._v(\"#\")]),t._v(\" POST /loki/api/v1/push\")]),t._v(\" \"),s(\"p\",[t._v(\"向loki发送日志条目的endpoint，默认POST主体是 snappy-compressed protobuf 消息\")]),t._v(\" \"),s(\"p\",[t._v(\"可以传 json 格式，设置 content-type为application/json\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-json extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"streams\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"stream\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"label\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"value\"')]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 标签，可以使用多个标签标识日志流\")]),t._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"values\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"<unix epoch in nanoseconds>\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"<log line>\"')]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 格式固定，时间戳+日志行\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"<unix epoch in nanoseconds>\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"<log line>\"')]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"\\n      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),s(\"h3\",{attrs:{id:\"其他\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#其他\"}},[t._v(\"#\")]),t._v(\" 其他\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"get-loki-api-v1-tail\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#get-loki-api-v1-tail\"}},[t._v(\"#\")]),t._v(\" GET /loki/api/v1/tail\")]),t._v(\" \"),s(\"p\",[t._v(\"websocket endpoint，根据查询来流转日志信息\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"get-ready\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#get-ready\"}},[t._v(\"#\")]),t._v(\" GET /ready\")]),t._v(\" \"),s(\"p\",[t._v(\"当Loki采集器准备好接受流量时，/ready会返回HTTP 200。如果在Kubernetes上运行Loki，可以作为准备就绪的探测器。\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"post-flush\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#post-flush\"}},[t._v(\"#\")]),t._v(\" POST /flush\")]),t._v(\" \"),s(\"p\",[t._v(\"触发刷新由ingesters持有的所有内存块到后备存储。主要用于本地测试。\")]),t._v(\" \"),s(\"h2\",{attrs:{id:\"logql\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#logql\"}},[t._v(\"#\")]),t._v(\" LogQL\")]),t._v(\" \"),s(\"p\",[t._v(\"如果需要进行更复杂的查询，可以自行编写LogQL\")]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://grafana.com/docs/loki/latest/logql/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"LogQL官方文档\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://cloud.tencent.com/developer/article/1839410\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Loki查询语言LogQL使用\"),s(\"OutboundLink\")],1),t._v(\"（相对较全面）\")]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://www.feiyiblog.com/2021/10/11/Loki%E7%9A%84LogQL%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Loki的LogQL查询语法\"),s(\"OutboundLink\")],1),t._v(\"（标签过滤+行过滤）\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"log query：返回日志行的内容\")]),t._v(\" \"),s(\"li\",[t._v(\"metric query：扩展了日志查询，根据查询结果来计算数值\")])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"loki配置-limits-config\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#loki配置-limits-config\"}},[t._v(\"#\")]),t._v(\" Loki配置 - Limits_Config\")]),t._v(\" \"),s(\"p\",[t._v(\"https://www.jianshu.com/p/2674c27d17c8\")]),t._v(\" \"),s(\"h2\",{attrs:{id:\"java简单应用\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#java简单应用\"}},[t._v(\"#\")]),t._v(\" Java简单应用\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-java extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[t._v(\"@Component\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"class\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"LokiService\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"private\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"final\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"WebClient\")]),t._v(\" webClient\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"private\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"static\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"final\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"String\")]),t._v(\" SYSLOG_QUERY_URL \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"loki/api/v1/query_range?query={query}&start={start}&end={end}&limit={limit}\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"private\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"static\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"final\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"String\")]),t._v(\" SYSLOG_PUSH_URL \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"loki/api/v1/push\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// LokiProperties中存储loki地址\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"LokiService\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"WebClient\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"Builder\")]),t._v(\" builder\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"LokiProperties\")]),t._v(\" properties\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"this\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"webClient \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" builder\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"baseUrl\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"properties\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"getUri\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"build\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 查询一定时间范围内的数据\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"DeviceSyslogsQueryRes\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"queryLogs\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Map\")]),s(\"span\",{pre:!0,attrs:{class:\"token generics\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"String\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"String\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\" params\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" webClient\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"get\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"uri\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"SYSLOG_QUERY_URL\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" params\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"retrieve\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"bodyToMono\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"ParameterizedTypeReference\")]),s(\"span\",{pre:!0,attrs:{class:\"token generics\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"DeviceSyslogsQueryRes\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"block\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 向loki推送数据\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"void\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"pushLogs\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Document\")]),t._v(\" request\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        webClient\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"post\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"uri\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"SYSLOG_PUSH_URL\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"bodyValue\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"request\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"retrieve\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"bodyToMono\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"ParameterizedTypeReference\")]),s(\"span\",{pre:!0,attrs:{class:\"token generics\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Result\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"String\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"map\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Result\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"::\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"getResult\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"block\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),s(\"h2\",{attrs:{id:\"可视化界面\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#可视化界面\"}},[t._v(\"#\")]),t._v(\" 可视化界面\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239046511-2dde2674-3a25-462a-aac2-d12ab701b344.png\",alt:\"img\"}})]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239065864-3f56e8a3-c48a-450b-b33b-9712d4e841ce.png\",alt:\"img\"}})]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239073520-8427b140-cf74-4bca-9a12-8a168d06e2b2.png\",alt:\"img\"}}),s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239126328-623c4ccd-8045-44f0-8742-c50c7a874afe.png\",alt:\"img\"}})]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239136913-cffcdbbf-d398-43a1-ba68-08646fe9c27c.png\",alt:\"img\"}})]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239142022-538c4cfb-605a-4c8d-98f6-874a8f18a8fe.png\",alt:\"img\"}})]),t._v(\" \"),s(\"p\",[t._v(\"官网:https://grafana.com/grafana/dashboards\\n\"),s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239161607-b6c5a56c-860a-4aa3-bc18-0b8a27507007.png\",alt:\"img\"}})]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239161725-2b2a3569-f017-4afe-b41b-dfeb56a9e141.png\",alt:\"img\"}})]),t._v(\" \"),s(\"p\",[t._v(\"简单粗暴，直接复制node_exporter 的ID导入仪表盘，当然也可以通过其他两种方式导入\\n\"),s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239161358-5dfe8b30-e068-42d3-af28-d4095fa2b17e.png\",alt:\"img\"}})]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239161430-31c86aff-3226-4140-a5d5-ef69420f3c15.png\",alt:\"img\"}}),t._v(\" \"),s(\"img\",{attrs:{src:\"https://typora-1304207839.cos.ap-chengdu.myqcloud.com/typora/1649239161653-def61622-d168-43ea-a5b3-f9eb574f1594.png\",alt:\"img\"}})]),t._v(\" \"),s(\"hr\"),t._v(\" \"),s(\"p\",[t._v(\"参考：\")]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://zhuanlan.zhihu.com/p/163809795\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"轻量级日志系统Loki原理简介和使用\"),s(\"OutboundLink\")],1),t._v(\"（环境搭建）\")]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://segmentfault.com/a/1190000040371914\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"再见笨重的ELK！这套轻量级日志收集方案要火\"),s(\"OutboundLink\")],1),t._v(\"（docker-compose安装）\")]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://cloud.tencent.com/developer/article/1668946\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Loki数据过期自动删除策略设计\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://juejin.cn/post/7008424451704356872#heading-3\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"LPG+SpringBoot收集日志\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"http://felord.cn/loki.html#%E7%AE%80%E5%8D%95%E4%B8%8A%E6%89%8B\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"SpringBoot2实战：轻量级日志loki集成\"),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://jishuin.proginn.com/p/763bfbd5a9aa\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Loki源码分析之日志写入\"),s(\"OutboundLink\")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);","extractedComments":[]}